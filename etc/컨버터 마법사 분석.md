




# [컨버터 마법사 분석]

## 1. 프로퍼티 분석

```C#
//InitConvertPageControl 에서 처음 초기화 할때 row["Count"]를 초기화해줌.
DataTable dtPedasObject;

//PDMS와 상관없는 데이터 테이블?
DataTable dtPart;

//메인폼의 dtSystemPath를 넘겨받음. 트리용 데이터 테이블일것임.
DataTable dtSystemPath; 

//메인 부모폼이 처음 만든 
//ConvertWizardForm 객체 즉 자기 자신임 
//이유는 메인에서 처음만든 객체에다가 객체 생성함. 
//아마 열려있다면 다시 열지 않게 if 처리되어있는것같음.
Form mainForm; 

//마법사를 실행한 부모 폼, 생성자 67에 있음
public Form SelfForm; 

List<PedasFileInfo> ConvertList = new List<PedasFileInfo>();
DataTable dtFooting = new DataTable();
DataTable dtPedestal = new DataTable();
DataTable dtTieGirder = new DataTable();
DataTable dtDummy = new DataTable();

ArrayList xGridColInfo_FDNList = new ArrayList();
ArrayList xGridColInfo_PEDList = new ArrayList();
ArrayList xGridColInfo_Tiegirder = new ArrayList();
ArrayList xGridColInfo_Dummy = new ArrayList();

List<string> FootingPropertyName = new List<string>();
List<string> FootingUserPropertyName = new List<string>();
List<string> FootingRingPropertyName = new List<string>();
List<string> PedestalPropertyName = new List<string>();
List<string> PedRingPropertyName = new List<string>();
List<string> TieGirderPropertyName = new List<string>();

List<FdnInfo> targetFooting = new List<FdnInfo>();
List<FdnPedInfo> targetPedestal = new List<FdnPedInfo>();
List<TieGirderInfo> targetTieGirder = new List<TieGirderInfo>();
List<DummyInfo> targetDummy = new List<DummyInfo>();

private RevisionDataType FocusedRevisionType = RevisionDataType.UnChanged;
private PedasFdnName SourcePedasType = PedasFdnName.Footing;

DataTable dtSummary = new DataTable();
DataTable dtCompare = new DataTable();

bool ConvertAction = false;
const int Step1Width = 865;
const int Step2Width = 960;
const int FormHeight = 590;
Point NowPoint;

List<RevisionItemInfo> PedasSystems;

private bool isClose = true;
private bool UseFdn = false, UsePile = false, UsePed = false, UseTie = false, UseSubBase = false;
private ToolTip toolTip = new ToolTip();
```

```C#
if(PedasData.ConvertProgramMode == ProgramMode.S3D)
{

}
else if (PedasData.ConvertProgramMode == ProgramMode.PDMS)
{

}
```


// Converter 파일 검사를 파일별로 할건지에 대한 여부
bool ownFile = rgRevisionOption.SelectedIndex == 1;

widow finish 이벤트가 컨버팅 실행하는 마지막 버튼인가.?
그러면 그 이벤트 실행되면 컨버팅하라고 PDMS한테 명령 날려야함
근데 명령형식 REGISTRY인데 잘 보고 판단할것.

분석 빨리해야해.

gvFoundation 을 셀렉트 한 행의 "Entity"컬럼안에 데이터가 들어있다. 형식은 FdnInfo다


보내는 데이터는 이러하다
dtPart
dtPedasObject
ConvertList
targetItem
ownFile


GlobalPedasInfos -> GlobalPedasInfos.[index] -> GlobalPedasInfos[index].FDN_LISTS ->

row["Entity"] = GlobalPedasInfos[index].FDN_LISTS[index]

dtFooting.Rows.Add(row)





해석화

using (MemoryStream stream = new MemoryStream())
                {
                    BinaryFormatter formatter = new BinaryFormatter();
                    formatter.Serialize(stream, item);
                    stream.Position = 0;
                    lstCopy.Add((T)formatter.Deserialize(stream));
                }






```xml
<?xml version="1.0" standalone="yes"?>
<NewDataSet>
  <CONVERTER_HEIGHTS_DATA>
    <FOOTING_HEIGHT>400</FOOTING_HEIGHT>
  </CONVERTER_HEIGHTS_DATA>
  <CONVERTER_HEIGHTS_DATA>
    <SCREEDTHK_HEIGHT>0</SCREEDTHK_HEIGHT>
    <LEANCONCRETE_HEIGHT>0.05</LEANCONCRETE_HEIGHT>
    <CRUSHEDSTONES_HEIGHT>0</CRUSHEDSTONES_HEIGHT>
  </CONVERTER_HEIGHTS_DATA>

  <CONVERTER_FOOTING_DATA>
    <XPOINT>-3.1</XPOINT>
    <YPOINT>-0.45</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_FOOTING_DATA>
  <CONVERTER_FOOTING_DATA>
    <XPOINT>2.3</XPOINT>
    <YPOINT>-0.45</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_FOOTING_DATA>
  <CONVERTER_FOOTING_DATA>
    <XPOINT>2.3</XPOINT>
    <YPOINT>2.65</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_FOOTING_DATA>
  <CONVERTER_FOOTING_DATA>
    <XPOINT>-3.1</XPOINT>
    <YPOINT>2.65</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_FOOTING_DATA>
  <CONVERTER_FOOTING_DATA>
    <XPOINT>-3.1</XPOINT>
    <YPOINT>-0.45</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_FOOTING_DATA>
  
  <CONVERTER_SUBBASE_DATA>
    <XPOINT>-3.2</XPOINT>
    <YPOINT>-0.55</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_SUBBASE_DATA>
  <CONVERTER_SUBBASE_DATA>
    <XPOINT>2.4</XPOINT>
    <YPOINT>-0.55</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_SUBBASE_DATA>
  <CONVERTER_SUBBASE_DATA>
    <XPOINT>2.4</XPOINT>
    <YPOINT>2.75</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_SUBBASE_DATA>
  <CONVERTER_SUBBASE_DATA>
    <XPOINT>-3.2</XPOINT>
    <YPOINT>2.75</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_SUBBASE_DATA>
  <CONVERTER_SUBBASE_DATA>
    <XPOINT>-3.2</XPOINT>
    <YPOINT>-0.55</YPOINT>
    <ZPOINT>-1.1</ZPOINT>
  </CONVERTER_SUBBASE_DATA>
</NewDataSet>
```





```C#
     if (foundationType == FoundationType.FOOTING
                || foundationType == FoundationType.SCREEDTHK
                || foundationType == FoundationType.LEANCONCRETE
                || foundationType == FoundationType.CRUSHEDSTONES)
                {

                    #region Footing, ScreedThk, LeanConcrete, CrushedStones 일때                                      
                    //EXTRUSION 생성
                    destinationElement = this.CreateDbElement(NOUN.EXTRUSION, destinationElement, extrusionName + temp_num.ToString());

                    //EXTRUSION HEIGHT 와 z위치를 설정해줘야함.
                    destinationElement.SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                            // * 1000d는 미터변환
                            0
                            , 0
                            //, this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
                            , this.StringToDouble(dtfdnGroup.Rows[0]["ZPOINT"].ToString()) * 1000d
                            - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                            ));

                    //fdnGroup의 FDN_ID와 같은 height를 가진 행만 가져옴.

                    double extrusion_height = this.StringToDouble(item_height[heightColumnName.ToString()].ToString());
                    destinationElement.SetAttribute(DbAttributeInstance.HEIG, extrusion_height); // Extrudion 높이 주기

                    //NXTRUSION 생성
                    this.CreateNegativeExtrusion(foundationType, destinationElement, dsConverterData, fdn_id, Guid.NewGuid().ToString(), Guid.NewGuid().ToString(), Guid.NewGuid().ToString());

                    //루프 생성
                    destinationElement = this.CreateDbElement(NOUN.LOOP, destinationElement, loopName + temp_num.ToString());

                    //Vertex(점)을 찍어줍니다. 
                    int i = 0;
                    //foreach (DataRow drConverterData in dtConverterData.Rows)
                    foreach (DataRow drConverterData in dtfdnGroup.Rows)
                    {
                        this.CreateDbElement(NOUN.VERTEX, destinationElement, vertexName + temp_num.ToString() + i++.ToString())
                            .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                            // * 1000d는 미터변환
                            this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                            , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                            , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d
                            - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                            ));
                    }

                    #endregion
                }
                else if (foundationType == FoundationType.PEDESTAL
                    || foundationType == FoundationType.PILE)
                {
                    #region PEDESTAL, PILE일때              
                    IEnumerable<IGrouping<object, DataRow>> groupBy = null;

                    //Gouping 구분
                    if (foundationType == FoundationType.PEDESTAL)
                    {
                        //Gouping 구분 : PED_ID
                        //groupBy = dtConverterData.AsEnumerable().GroupBy(row => row["PED_ID"]);
                        groupBy = dtfdnGroup.AsEnumerable().GroupBy(row => row["PED_ID"]);
                    }
                    else if (foundationType == FoundationType.PILE)
                    {
                        //Gouping 구분 : PILE_ID
                        //groupBy = dtConverterData.AsEnumerable().GroupBy(row => row["PILE_ID"]);
                        groupBy = dtfdnGroup.AsEnumerable().GroupBy(row => row["PILE_ID"]);
                    }                 

                    //이름 중복 방지용
                    int i = 0;
                    int j = 0;
                    //목적지 엘리먼트 리셋
                    DbElement temp = destinationElement;
                    foreach (var group in groupBy)
                    {
                        destinationElement = this.CreateDbElement(NOUN.EXTRUSION, destinationElement, extrusionName + temp_num.ToString() + j.ToString());
                        destinationElement.SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                            // * 1000d는 미터변환
                            0
                            , 0
                            , this.StringToDouble(dtfdnGroup.Rows[0]["ZPOINT"].ToString()) * 1000d
                            - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                            ));
                        //double extrusion_height = this.StringToDouble(dtConverterData_Heights.Rows[0][heightColumnName.ToString()].ToString());
                        double extrusion_height = this.StringToDouble(item_height[heightColumnName.ToString()].ToString());
                        destinationElement.SetAttribute(DbAttributeInstance.HEIG, extrusion_height); // Extrudion 높이 주기

                        if (foundationType == FoundationType.PEDESTAL)
                        {
                            this.CreateNegativeExtrusion(foundationType, destinationElement, fdn_id, Guid.NewGuid().ToString(), Guid.NewGuid().ToString(), Guid.NewGuid().ToString());
                        }

                        destinationElement = this.CreateDbElement(NOUN.LOOP, destinationElement, loopName + temp_num.ToString() + j.ToString());
                        foreach (DataRow drConverterData in group)
                        {
                            this.CreateDbElement(NOUN.VERTEX, destinationElement, vertexName + temp_num.ToString() + j.ToString() + i++.ToString())
                                .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                                // * 1000d는 미터변환
                                this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                                , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                                , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d
                                - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                                ));
                        }
                        //목적지 엘리먼트 리셋
                        destinationElement = temp;
                        j++;
                    }
                    #endregion
                }
                else if (foundationType == FoundationType.TIEGIRDER)
                {
                    #region TieGirder 일때
                    destinationElement = this.CreateDbElement(NOUN.EXTRUSION, destinationElement, extrusionName + temp_num.ToString());
                    
                    destinationElement.SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                            // * 1000d는 미터변환
                            0
                            , 0
                            //, this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
                            , this.StringToDouble(dtfdnGroup.Rows[0]["ZPOINT"].ToString()) * 1000d                            
                            ));

                    double extrusion_height = this.StringToDouble(dtfdnGroup.Rows[0]["TIEGIRDER_HEIGHT"].ToString());
                    destinationElement.SetAttribute(DbAttributeInstance.HEIG, extrusion_height); // Extrudion 높이 주기
                                        
                    destinationElement = this.CreateDbElement(NOUN.LOOP, destinationElement, loopName + temp_num.ToString());
                    
                    int i = 0;
                    foreach (DataRow drConverterData in dtfdnGroup.Rows)
                    {
                        this.CreateDbElement(NOUN.VERTEX, destinationElement, vertexName + temp_num.ToString() + i++.ToString())
                            .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                            // * 1000d는 미터변환
                            this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                            , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                            , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d                            
                            ));
                    }
                    #endregion
                }
```


```C#
  DbElement tempElement = DbElement.GetElement("/*");
                tempElement = this.CreateDbElement(NOUN.SITE, tempElement, "PEDAS_Site_TEST");
                tempElement = this.CreateDbElement(NOUN.ZONE, tempElement, "PEDAS_Zone_TEST");
                tempElement = this.CreateDbElement(NOUN.EQUIPMENT, tempElement, "PEDAS_Equipment_TEST");
                //tempElement = this.CreateDbElement(NOUN.EXTRUSION, tempElement, "PEDAS_Extrusion_TEST");

                tempElement = this.CreateDbElement(NOUN.POHEDRON, tempElement, "PEDAS_POHEDRON_TEST");
                //tempElement.SetAttribute(DbAttributeInstance.HEIG, this.StringToDouble(this.txtExtrusionHeightPEDAS.Text));
                tempElement = this.CreateDbElement(NOUN.POGON, tempElement, "PEDAS_POGON_TEST");
                this.CreateDbElement(NOUN.POINT, tempElement, "PEDAS_POINT_TEST")
                    .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                        
                        
                        ));
```

```C#
private static FdnPedInfo GetTeklaPed(PedasModelItem item)
{
    ContourPlate plate = item.Plate;
    FdnPedInfo ped = new FdnPedInfo();
    ped.IsS3D = true;
    var points = GetPoints(plate);
    ped.S3D_Note = item.Note;

    // FILE_ID◆PROJECT◆UNIT◆MODEL◆EQUIP◆PED_NAMES◆FDN_NAME
    string[] arr = item.Note.Split('◆');
    ped.PED_NAME = arr[arr.Length - 1];
    points.ForEach(x => x.FILE_ID = arr[0]);
    ped.FdnPedPointList = points;

    // Dim에서 추출
    //ped.GlobalX = Math.Round((points.Max(x => x.X) - points.Min(x => x.X)) / 2 + points.Min(x => x.X), 3);
    //ped.GlobalY = Math.Round((points.Max(x => x.Y) - points.Min(x => x.Y)) / 2 + points.Min(x => x.Y), 3);
    ped.GlobalZ = Math.Round(points.Max(x => x.Z), 3);
    //ped.dx = Math.Round((points.Max(x => x.X) - points.Min(x => x.X)) * 1000, 3);
    //ped.dy = Math.Round((points.Max(x => x.Y) - points.Min(x => x.Y)) * 1000, 3);

    double.TryParse(plate.Profile.ProfileString.Substring(2, plate.Profile.ProfileString.Length - 2), out double hf);
    ped.Hp = hf;

    GetDimValue(PedasFdnName.Pedestal, item.NoteDim, null, ped, null);

    ped.dx = ped.dx_dim;
    ped.dy = ped.dy_dim;

    // Hole Point 같이 추가하여 계산
    ped.FdnPedPointList.AddRange(item.HolePoints);

    return ped;
}
```

```C#
private static FdnInfo GetTeklaFdn(PedasModelItem item)
{
    ContourPlate plate = item.Plate;
    FdnInfo fdn = new FdnInfo();
    fdn.IsS3D = true;

    var points = GetPoints(plate);
    fdn.S3D_Note = item.Note;

    // FILE_ID◆PROJECT◆UNIT◆MODEL◆EQUIP◆PED_NAMES◆FDN_NAME
    string[] arr = item.Note.Split('◆');
    fdn.FDN_Name = arr[arr.Length - 1];
    points.ForEach(x => x.FILE_ID = arr[0]);
    fdn.FdnPointList = points;
    fdn.isPileFdn = false; // Pile에서 다시 판단

    // Dim에서 추출
    //fdn.GlobalX = Math.Round((points.Max(x => x.X) - points.Min(x => x.X)) / 2 + points.Min(x => x.X), 3);
    //fdn.GlobalY = Math.Round((points.Max(x => x.Y) - points.Min(x => x.Y)) / 2 + points.Min(x => x.Y), 3);
    fdn.GlobalZ = Math.Round(points.Max(x => x.Z), 3);
    //fdn.Lx_mm = Math.Round((points.Max(x => x.X) - points.Min(x => x.X)) * 1000, 3);
    //fdn.Ly_mm = Math.Round((points.Max(x => x.Y) - points.Min(x => x.Y)) * 1000, 3);

    double.TryParse(plate.Profile.ProfileString.Substring(2, plate.Profile.ProfileString.Length - 2), out double hf);
    fdn.Hf_mm = hf;

    GetDimValue(PedasFdnName.Footing, item.NoteDim, fdn, null, null);

    fdn.Lx_mm = fdn.lx_dim;
    fdn.Ly_mm = fdn.ly_dim;

    // Hole Point 같이 추가하여 계산
    fdn.FdnPointList.AddRange(item.HolePoints);

    return fdn;
}
```

```C#
private static List<FdnPoint> GetPoints(ContourPlate plate)
{
    var points = new List<FdnPoint>();

    foreach (ContourPoint pt in plate.Contour.ContourPoints)
    {
        FdnPoint f = new FdnPoint();
        f.X = pt.X / 1000;
        f.Y = pt.Y / 1000;
        f.Z = pt.Z / 1000;

        if (points.Contains(f) == false)
            points.Add(f);
    }

    // 좌표 중복 제거 하여 추가
    return points;
}
```

```C#
private static void GetTeklaFdnPile(List<PedasModelItem> piles, FdnInfo fdn)
{
    if (piles.Count == 0) return;

    fdn.isPileFdn = true;
    fdn.Pile_Ea = piles.Count;

    foreach (var el in piles)
    {
        ContourPlate plate = el.Plate;

        string[] arr = el.Note.Split('◆');

        fdn.Pile_Shape = arr[8]; // "Rectangle", "Circle"
        fdn.Pile_Diameter = arr[9].ExToDouble();
        fdn.PilePrefix = arr[10];
        fdn.PileNo = arr[11].ExToInt();

        var points = GetPoints(plate);
        points.ForEach(x => x.FILE_ID = arr[0]);

        double.TryParse(plate.Profile.ProfileString.Substring(2, plate.Profile.ProfileString.Length - 2), out double hf);
        fdn.PileLength_mm = hf;

        break;
    }
}
    string note = $"{fdn.S3D_Note}◆PI◆{fdn.Pile_Shape}◆{fdn.Pile_Diameter}◆{fdn.PilePrefix}◆{fdn.PileNo}";
            string noteItem = $"{fdn.S3D_Note}◆PI◆{fdn.Pile_Shape}◆{fdn.Pile_Diameter}◆{fdn.PilePrefix}◆{item.PileID}";
```


```C#
private static TieGirderInfo GetTeklaTie(PedasModelItem item)
{
    TieGirderInfo tie = new TieGirderInfo();
    tie.IsS3D = true;

    ContourPlate plate = item.Plate;

    var points = GetPoints(plate);
    List<TieGirderPointInfo> tiePoints = new List<TieGirderPointInfo>();
    foreach (var sp in points)
    {
        // ID 와 NUM 은 의미 없음
        tiePoints.Add(new TieGirderPointInfo(0, sp.X, sp.Y, sp.Z));
    }

    // 좌표 하나 더해줌 (Revision 시 중복제거 하여 비교)
    tiePoints.Add(tiePoints[0]);

    tie.TGPoints = tiePoints;

    // FILE_ID◆PROJECT◆UNIT◆MODEL◆EQUIP◆PED_NAMES◆FDN_NAME
    string[] arr = item.Note.Split('◆');
    tie.Name = arr[arr.Length - 1];

    tie.S3D_Note = item.Note;

    double.TryParse(plate.Profile.ProfileString.Substring(2, plate.Profile.ProfileString.Length - 2), out double hf);
    tie.Height = hf / 1000;

    GetDimValue(PedasFdnName.TieGirder, item.NoteDim, null, null, tie);

    return tie;
}
```


```C#

public class SomethingClass
    {

        //Some codes...
        public void CreateCircle(string SomethingPathName)
        {
            var element = CreateExtrusion(SomethingPathName);

            //some codes goes like below
            element.foofoo = bar;

            var element = CreateLoop(element);

            foreach (var foo in bar)
            {
                var element = CreateVertices(element);
            }
        }

        public void CreateRectangle(string SomethingPathName)
        {
            var element = CreateExtrusion(SomethingPathName);

            var element = CreateLoop(element);

            foreach (var foo in bar)
            {
                var element = CreateVertices(element);
            }
        }

        public void CreatePyramid(string SomethingPathName)
        {
            var element = CreateExtrusion(SomethingPathName);

            var element = CreateLoop(element);

            foreach (var foo in bar)
            {
                var element = CreateVertices(element);
            }
        }

        // so one...

        //Some codes...
    }
```

```C#
private void CreateFoundation(FoundationType foundationType, FoundationColumnName heightColumnName, DbElement objectiveElement, DataSet dsConverterData, DataTable dtConverterData, DataRow item_height, string extrusionName, string s3d_note, Guid PDMS_GROUP_ID)
{
    if (foundationType == FoundationType.FOOTING
      || foundationType == FoundationType.SCREEDTHK
      || foundationType == FoundationType.LEANCONCRETE
      || foundationType == FoundationType.CRUSHEDSTONES)
    {
        #region Footing, ScreedThk, LeanConcrete, CrushedStones                
        objectiveElement = this.CreateExtrusion(foundationType
            , objectiveElement
            , this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
            - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
            , this.StringToDouble(item_height[heightColumnName.ToString()].ToString())
            , extrusionName
            , PDMS_GROUP_ID
            , s3d_note
            , dsConverterData.Tables[TableName.CONVERTER_FOUNDATIONS_DATA.ToString()].Rows[0][FoundationColumnName.NOTE_DIM.ToString()].ToString());

        //NXTRUSION 생성
        this.CreateHole(foundationType, objectiveElement, dsConverterData, extrusionName, PDMS_GROUP_ID, s3d_note);

        //create loop
        objectiveElement = this.CreateLoop(objectiveElement, Guid.NewGuid().ToString());

        //create vertices                      
        foreach (DataRow drConverterData in dtConverterData.Rows)
        {
            this.CreateVertex(
                objectiveElement
                , Guid.NewGuid().ToString()
                , StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                , StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d
                - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName));                             
        }
        #endregion
    }
    else if (foundationType == FoundationType.PEDESTAL)
    {
        #region PEDESTAL                             
        //Gouping 구분 : PED_ID
        var groupBy_PED_ID = dtConverterData.AsEnumerable().GroupBy(row => row["PED_ID"]);
        string fdn_name_no = extrusionName;

        //목적지 엘리먼트 리셋
        DbElement temp_dest_equip = objectiveElement;
        foreach (var group_PED_ID in groupBy_PED_ID)
        {
            string ped_name = dsConverterData.Tables[TableName.CONVERTER_PEDESTAL_DATA.ToString()]
            .AsEnumerable()
            .Where(row0 => row0["PED_ID"].ToString() == group_PED_ID.AsEnumerable().FirstOrDefault()["PED_ID"].ToString())
            .Select(row => row["PED_NAME"].ToString()).FirstOrDefault().ToString();
            ped_name = Regex.Replace(ped_name, @"\s+", "");              

            objectiveElement = this.CreateExtrusion(
                foundationType
                , objectiveElement
                , this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
                , this.StringToDouble(group_PED_ID.AsEnumerable().Select(row => row["PEDESTAL_HEIGHT"]).FirstOrDefault().ToString())
                , "(Pedestal)" + ped_name
                , PDMS_GROUP_ID
                , group_PED_ID.AsEnumerable().Select(row => row["S3D_NOTE"]).FirstOrDefault().ToString()
                , group_PED_ID.AsEnumerable().Select(row => row["NOTE_DIM"]).FirstOrDefault().ToString());

            DbElement temp_pedestal = objectiveElement;

            this.CreateHole(foundationType
                , objectiveElement
                , dsConverterData
                , ped_name
                , PDMS_GROUP_ID
                , group_PED_ID.AsEnumerable().Select(row => row["S3D_NOTE"]).FirstOrDefault().ToString());

            objectiveElement = this.CreateLoop(objectiveElement, Guid.NewGuid().ToString());

            foreach (DataRow drConverterData in group_PED_ID)
            {
                this.CreateVertex(objectiveElement, Guid.NewGuid().ToString()
                    , this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d);
            }

            #region grout
            //목적지 엘리먼트 리셋
            objectiveElement = temp_dest_equip;
            objectiveElement = this.CreateExtrusion(
                FoundationType.GROUT
                , objectiveElement
              , this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
              + this.StringToDouble(group_PED_ID.AsEnumerable().Select(row => row["PEDESTAL_HEIGHT"]).FirstOrDefault().ToString())
              , this.StringToDouble(group_PED_ID.AsEnumerable().Select(row => row["GROUT_THK"]).FirstOrDefault().ToString())
              , "(Grout)" + ped_name
              , PDMS_GROUP_ID
              , group_PED_ID.AsEnumerable().Select(row => row["S3D_NOTE"]).FirstOrDefault().ToString());

            this.CreateHole(FoundationType.GROUT
                , objectiveElement
                , dsConverterData
                , ped_name
                , PDMS_GROUP_ID
                , group_PED_ID.AsEnumerable().Select(row => row["S3D_NOTE"]).FirstOrDefault().ToString());

            objectiveElement = this.CreateLoop(objectiveElement, Guid.NewGuid().ToString());

            foreach (DataRow drConverterData in group_PED_ID)
            {
                this.CreateVertex(objectiveElement, Guid.NewGuid().ToString()
                    , this.StringToDouble(drConverterData["GROUT_XPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["GROUT_YPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["GROUT_ZPOINT"].ToString()) * 1000d);

            }

            //목적지 엘리먼트 리셋
            objectiveElement = temp_dest_equip;
            #endregion                   
        }
        #endregion
    }
    else if (foundationType == FoundationType.PILE)
    {
        #region PILE           
        var groupBy_PILE_ID = dtConverterData.AsEnumerable().GroupBy(row => row["PILE_ID"]);

        //목적지 엘리먼트 리셋
        DbElement temp_dest_equip = objectiveElement;
        foreach (var group_PILE_ID in groupBy_PILE_ID)
        {
            DataRow drPile = group_PILE_ID.ToList().FirstOrDefault();
            string pile_note = $"{s3d_note}◆PI◆{drPile["PILE_SHAPE"]}◆{drPile["PILE_DIAMETER"]}◆{drPile["PILE_PREFIX"]}◆{drPile["PILE_NO"]}";
            string pile_noteItem = $"{s3d_note}◆PI◆{drPile["PILE_SHAPE"]}◆{drPile["PILE_DIAMETER"]}◆{drPile["PILE_PREFIX"]}◆{drPile["PILE_ID"]}";

            objectiveElement = this.CreateExtrusion(foundationType
                , objectiveElement
                , this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
                , this.StringToDouble(item_height[heightColumnName.ToString()].ToString())
                , extrusionName
                , PDMS_GROUP_ID
                , pile_note
                , ""
                , pile_noteItem);

            objectiveElement = this.CreateLoop(objectiveElement, Guid.NewGuid().ToString());

            foreach (DataRow drConverterData in group_PILE_ID)
            {
                this.CreateVertex(objectiveElement, Guid.NewGuid().ToString()
                    , this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                    , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d);
            }
            //목적지 엘리먼트 리셋
            objectiveElement = temp_dest_equip;
        }
        #endregion
    }
    else if (foundationType == FoundationType.TIEGIRDER)
    {
        #region TieGirder                
        objectiveElement = this.CreateExtrusion(
            foundationType
            , objectiveElement
            , this.StringToDouble(dtConverterData.Rows[0]["ZPOINT"].ToString()) * 1000d
            , this.StringToDouble(dtConverterData.Rows[0]["TIEGIRDER_HEIGHT"].ToString())
            , extrusionName
            , PDMS_GROUP_ID
            , s3d_note
            , dsConverterData.Tables[TableName.CONVERTER_TIEGIRDER_DATA.ToString()].Rows[0][FoundationColumnName.NOTE_DIM.ToString()].ToString());

        objectiveElement = this.CreateLoop(objectiveElement, Guid.NewGuid().ToString());

        foreach (DataRow drConverterData in dtConverterData.Rows)
        {
            this.CreateVertex(objectiveElement, Guid.NewGuid().ToString()
                , this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d);
        }
        #endregion
    }
}
```

```C#
var tempPoint = new List<FdnPoint>();
                            tempPoint.AddRange(fdn.FdnRevitPointList);
                            //tempPoint.RemoveAt(fdn.FdnPointList.Count - 1);                            

                            foreach (var op in fdn.FdnHolePointList)
                            {
                                foreach (var fdnHolePoint in op)
                                {
                                    fdnHolePoint.GlobalZ = 0;
                                }
                                tempPoint.AddRange(op);
                                //tempPoint.RemoveAt(tempPoint.Count - 1);
                            }

                            //PDMS일때 모형에 상관없이 포인트좌표 비교
                            if (CompareFdnPoint(tempPoint, targetItem.FdnPointList))
                            {
                                revisionDataType = RevisionDataType.Modified;
                            }
```

```C#
 if(PedasData.ConvertProgramMode == ProgramMode.S3D)
                        {

                        }
                        else if (PedasData.ConvertProgramMode == ProgramMode.PDMS)
                        {

                        }
```

```C#
  var tempPoint = new List<FdnPoint>();
                            tempPoint.AddRange(ped.FdnPedPointList);                                                                            

                            foreach (var fdnHolePoint in ped.FdnPedHolePointList)
                            {
                                fdnHolePoint.GlobalZ = 0;
                            }
                            tempPoint.AddRange(ped.FdnPedHolePointList);
                            
                            if (CompareFdnPoint(tempPoint, targetItem.FdnPedPointList))
                            {
                                revisionDataType = RevisionDataType.Modified;
                            }
```

```C#
 #region Polyhedron 참고...ㅠ
                    //Grout_Thk
                    //Pedestal의 Grout_Thk가 0 이상이면 그라우트가 존재하므로 그려야함.                  
                    //if (this.StringToDouble(dtfdnGroup.Rows[0]["GROUT_THK"].ToString()) > 0)
                    //    {
                    //        //destinationElement = this.CreateDbElement(NOUN.EXTRUSION, destinationElement, extrusionName + j.ToString());
                    //        //destinationElement.SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //        //    // * 1000d는 미터변환
                    //        //    0
                    //        //    , 0
                    //        //    , this.StringToDouble(dtfdnGroup.Rows[0]["ZPOINT"].ToString()) * 1000d
                    //        //     + this.StringToDouble(item_height[heightColumnName.ToString()].ToString()) //Grout의 시작높이 : Pedestal의 GlobalZ와 높이를 더한값
                    //        //    ));
                    //        //extrusion_height = this.StringToDouble(dtfdnGroup.Rows[0]["GROUT_THK"].ToString());
                    //        //destinationElement.SetAttribute(DbAttributeInstance.HEIG, extrusion_height); // Extrudion 높이 주기

                    //        //this.CreateNegativeExtrusion(foundationType, destinationElement, dsConverterData, fdn_id, Guid.NewGuid().ToString(), Guid.NewGuid().ToString(), Guid.NewGuid().ToString());

                    //        //destinationElement = this.CreateDbElement(NOUN.LOOP, destinationElement, loopName + j.ToString());
                    //        //foreach (DataRow drConverterData in group)
                    //        //{
                    //        //    this.CreateDbElement(NOUN.VERTEX, destinationElement, vertexName + j.ToString() + i++.ToString())
                    //        //        .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //        //        // * 1000d는 미터변환
                    //        //        this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    //        //        , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                    //        //        , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d
                    //        //        ));
                    //        //}
                    //        ////목적지 엘리먼트 리셋
                    //        //destinationElement = temp_destination;
                    //        //j++;

                    //        destinationElement = this.CreateDbElement(NOUN.POHEDRON, destinationElement, extrusionName + j.ToString());
                    //        destinationElement.SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //            // * 1000d는 미터변환
                    //            0
                    //            ,0
                    //            ,0//, this.StringToDouble(dtfdnGroup.Rows[0]["ZPOINT"].ToString()) * 1000d
                    //            ));

                    //        DbElement temp_POHEDRON_destination = destinationElement;

                    //        //Grout 아래 : PEDESTAL의 좌표랑 같다.
                    //        destinationElement = this.CreateDbElement(NOUN.POGON, destinationElement, loopName + j++.ToString());                            
                    //        foreach (DataRow drConverterData in group)
                    //        {
                    //            this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "A")
                    //                .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                // * 1000d는 미터변환
                    //                this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    //                , this.StringToDouble(drConverterData["YPOINT"].ToString()) * 1000d
                    //                , this.StringToDouble(drConverterData["ZPOINT"].ToString()) * 1000d + extrusion_height                                    
                    //                ));
                    //        }

                    //        //Grout 위
                    //        destinationElement = temp_POHEDRON_destination;
                    //        destinationElement = this.CreateDbElement(NOUN.POGON, destinationElement, loopName + j++.ToString());                            
                    //        foreach (DataRow drConverterData in group)
                    //        {
                    //            this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "B")
                    //                .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                // * 1000d는 미터변환
                    //                this.StringToDouble(drConverterData["GROUT_XPOINT"].ToString()) * 1000d
                    //                , this.StringToDouble(drConverterData["GROUT_YPOINT"].ToString()) * 1000d
                    //                , this.StringToDouble(drConverterData["GROUT_ZPOINT"].ToString()) * 1000d                                    
                    //                ));
                    //        }


                    //    //////Grout 옆1
                    //    //destinationElement = temp_POHEDRON_destination;
                    //    //destinationElement = this.CreateDbElement(NOUN.POGON, destinationElement, loopName + j++.ToString());

                    //    //foreach (DataRow drConverterData in group)
                    //    //{
                    //    //    this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "C")
                    //    //       .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //    //       // * 1000d는 미터변환
                    //    //       this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    //    //       , this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d
                    //    //       , this.StringToDouble(drConverterData["XPOINT"].ToString()) * 1000d + extrusion_height
                    //    //       - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                    //    //       ));

                    //    //    this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "B")
                    //    //        .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //    //        // * 1000d는 미터변환
                    //    //        this.StringToDouble(drConverterData["GROUT_XPOINT"].ToString()) * 1000d
                    //    //        , this.StringToDouble(drConverterData["GROUT_YPOINT"].ToString()) * 1000d
                    //    //        , this.StringToDouble(drConverterData["GROUT_ZPOINT"].ToString()) * 1000d
                    //    //        - GetSubBase_Z_HeightForCalculation(item_height, heightColumnName)
                    //    //        ));
                    //    //}

                    //    //Grout 옆
                    //    var ss = group.AsEnumerable().ToList();
                    //        for (int index = 0; index < ss.Count; index++)
                    //        {

                    //            destinationElement = temp_POHEDRON_destination;
                    //            destinationElement = this.CreateDbElement(NOUN.POGON, destinationElement, loopName + j++.ToString());


                    //            this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "C")
                    //                      .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                      // * 1000d는 미터변환
                    //                      this.StringToDouble(ss[index]["XPOINT"].ToString()) * 1000d
                    //                      , this.StringToDouble(ss[index]["YPOINT"].ToString()) * 1000d
                    //                      , this.StringToDouble(ss[index]["ZPOINT"].ToString()) * 1000d + extrusion_height                                          
                    //                      ));

                    //            this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "B")
                    //                     .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                     // * 1000d는 미터변환
                    //                     this.StringToDouble(ss[index]["GROUT_XPOINT"].ToString()) * 1000d
                    //                     , this.StringToDouble(ss[index]["GROUT_YPOINT"].ToString()) * 1000d
                    //                     , this.StringToDouble(ss[index]["GROUT_ZPOINT"].ToString()) * 1000d                                         
                    //                     ));
                    //            if(ss.Count > index + 1)
                    //            {
                    //                this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "B")
                    //                       .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                    // * 1000d는 미터변환
                    //                    this.StringToDouble(ss[index + 1]["GROUT_XPOINT"].ToString()) * 1000d
                    //                       , this.StringToDouble(ss[index + 1]["GROUT_YPOINT"].ToString()) * 1000d
                    //                       , this.StringToDouble(ss[index + 1]["GROUT_ZPOINT"].ToString()) * 1000d                                           
                    //                       ));

                    //                this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "C")
                    //                         .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                         // * 1000d는 미터변환
                    //                         this.StringToDouble(ss[index + 1]["XPOINT"].ToString()) * 1000d
                    //                         , this.StringToDouble(ss[index + 1]["YPOINT"].ToString()) * 1000d
                    //                         , this.StringToDouble(ss[index + 1]["ZPOINT"].ToString()) * 1000d + extrusion_height                                             
                    //                         ));
                    //            }
                    //            else
                    //            {
                    //                this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "B")
                    //                       .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                    // * 1000d는 미터변환
                    //                    this.StringToDouble(ss[0]["GROUT_XPOINT"].ToString()) * 1000d
                    //                       , this.StringToDouble(ss[0]["GROUT_YPOINT"].ToString()) * 1000d
                    //                       , this.StringToDouble(ss[0]["GROUT_ZPOINT"].ToString()) * 1000d                                           
                    //                       ));

                    //                this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "C")
                    //                        .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                        // * 1000d는 미터변환
                    //                         this.StringToDouble(ss[0]["XPOINT"].ToString()) * 1000d
                    //                        , this.StringToDouble(ss[0]["YPOINT"].ToString()) * 1000d
                    //                        , this.StringToDouble(ss[0]["ZPOINT"].ToString()) * 1000d + extrusion_height                                            
                    //                        ));
                    //            }

                    //            this.CreateDbElement(NOUN.POINT, destinationElement, vertexName + j.ToString() + i++.ToString() + "C")
                    //                      .SetAttribute(DbAttributeInstance.POS, this.GetGeometryPosition(
                    //                      // * 1000d는 미터변환
                    //                      this.StringToDouble(ss[index]["XPOINT"].ToString()) * 1000d
                    //                      , this.StringToDouble(ss[index]["YPOINT"].ToString()) * 1000d
                    //                      , this.StringToDouble(ss[index]["ZPOINT"].ToString()) * 1000d + extrusion_height                                          
                    //                      ));

                    //        }

                    //        //목적지 엘리먼트 리셋
                    //        destinationElement = temp_destination;
                    //        j++;

                    //    }
                    #endregion
```

```C#
private void GvPedestal_CustomDrawGroupRow(object sender, DevExpress.XtraGrid.Views.Base.RowObjectCustomDrawEventArgs e)
{
    DevExpress.XtraGrid.Views.Grid.ViewInfo.GridGroupRowInfo info = e.Info as DevExpress.XtraGrid.Views.Grid.ViewInfo.GridGroupRowInfo;

    if (info.Column.FieldName == "PEDType_ID")
    {
        int PEDTYPEID = Convert.ToInt32(gvPedestal.GetGroupRowValue(e.RowHandle, info.Column));

        List<FdnInfo> temp = new List<FdnInfo>();

        string sCount = dtPedestal.Select(string.Format("PEDType_ID = '{0}'", PEDTYPEID)).Length.ToString();

        var tempType = PedasData.PEDTypeList.Where(i => i.PEDType_ID == PEDTYPEID).FirstOrDefault();

        if (tempType != null)
        {
            string sdx = tempType.dx.ToString();
            string sdy = tempType.dy.ToString();
            string sHp = tempType.Hp.ToString();

            int TypeIndex = PedasData.PEDTypeList.IndexOf(tempType) + 1;

            info.GroupText = "<color=Blue>[" + sdx + " x " + sdy + " x " + sHp + " ] [ " + sCount + " - EA ]</color>";
        }

        else
        {
            info.GroupText = "<color=Blue>Deleted [" + sCount + " - EA. ]</color>";
        }
    }
    else if (info.Column.FieldName == "SystemName")
    {
        info.GroupText = "     " + info.GroupValueText;

        var rows = dtSystemPath.Select(string.Format("Name = '{0}'", info.GroupValueText));

        int selectedIndex = 0;
        if (rows.Length > 0)
        {
            selectedIndex = GetSystemImage(rows[0]);
        }

        Image img = Common.GetFoundationImageCollection().Images[selectedIndex];
        e.Painter.DrawObject(e.Info);
        Point imgPos = GetImagePosition(new Point(info.ButtonBounds.Right, info.ButtonBounds.Y), e.Graphics, info.Appearance.Font, gvFoundation.GetGroupRowDisplayText(rowHandle: e.RowHandle));
        e.Graphics.DrawImage(img, new Point(info.DataBounds.X + 40, imgPos.Y));

        e.Handled = true;
    }
}

```


```C#
 SplashScreen13.Wait.Show("hello world", "asdasdasd");
                int i = 0;
                while(true)
                {
                    SplashScreen13.Wait.SetDescription(string.Format("[{0} / {1}] Foundation Name : {2}", i, i, i++));
                }
```

``` C#
  private void SetPedasItemDesignExplorerToList()
        {
            //최상위 World 가져오기
            var world_row = this.PedasItemDesignExplorer
           .AsEnumerable()
           .Where(x => x["DBELEMENTTYPE"].ToString() == "WORLD")
           .FirstOrDefault();

            //최상위 World는 있어야함
            if (world_row != null)
            {
                // 최상위 World 먼저 추가
                if (MainSystemPath.Exists(x => x.ID == world_row["REFNO"].ToString()) == false)
                {
                    PedasItemDesignExplorerPath.Add(new SystemPath(world_row["REFNO"].ToString(), "", world_row["NAME"].ToString(), MainSystemPathType.Root, world_row["DBELEMENTTYPE"].ToString()));
                }

                foreach(DataRow dbElement_row in this.PedasItemDesignExplorer.Rows)
                {
                    if(dbElement_row["DBELEMENTTYPE"].ToString() != "WORLD")
                    {
                        PedasItemDesignExplorerPath.Add(new SystemPath(dbElement_row["REFNO"].ToString(), world_row["REFNO"].ToString(), dbElement_row["NAME"].ToString(), dbElement_row["DBELEMENTTYPE"].ToString()));
                    }
                }
            }
        }
```

```C#
tlSystemPath.RefreshDataSource();
                if(PedasData.ConvertProgramMode == ProgramMode.S3D)
                {
                    CalcSystemPath();
                }
                else if (PedasData.ConvertProgramMode == ProgramMode.PDMS)
                {
                    CalcSystemPath();
                    this.PedasItemDesignExplorerPath.Clear();
                    this.PedasItemDesignExplorerPath = frm.PedasItemDesignExplorerPath;
                    this.SetMainpathTOPedasItemDesignExplorer();
                }

 SplashScreen13.Wait.Show(this, "Loading Design Explorer Data...");    
                clsBasic.SetRegistryValue("PDMSCommand", nameof(CommandMessage.CONVERTER_DATA_REQUEST));
```


```
 //if (bandedGridView1.FocusedColumn.FieldName == "SoilType")
            //{
            //    #region Soil Type에 따른 Elastic modulus E Method셋팅
            //    SoilType soilType = CommonHelper.GetSoilType(bandedGridView1.GetFocusedRowCellValue("SoilType").ToString());
            //    var index_CU300 = cbExpressionElastic.Items.IndexOf(CU300);
            //    var index_Kpa = cbExpressionElastic.Items.IndexOf(Kpa);
            //    CommonHelper.SetDefaultMethod(soilType, row);

            //    // 관계식 다시 세팅
            //    switch (soilType)
            //    {
            //        case SoilType.Sand:
            //            {
            //                if (index_CU300 > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_CU300]);

            //                if (index_Kpa > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_Kpa]);
            //            }
            //            break;
            //        case SoilType.Silt:
            //            {
            //                if (index_CU300 > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_CU300]);

            //                if (index_Kpa > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_Kpa]);
            //            }
            //            break;
            //        case SoilType.Clay:
            //            {
            //                if (index_CU300 < 0)
            //                    cbExpressionElastic.Items.Insert(cbExpressionElastic.Items.Count - 1, CU300);

            //                if (index_Kpa > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_Kpa]);
            //            }
            //            break;
            //        case SoilType.Rock:
            //            {
            //                if (index_CU300 > 0)
            //                    cbExpressionElastic.Items.Remove(cbExpressionElastic.Items[index_CU300]);

            //                if (index_Kpa < 0)
            //                    cbExpressionElastic.Items.Insert(cbExpressionElastic.Items.Count - 1, Kpa);
            //            }
            //            break;
            //    }

            //    if (row["SourceOfInfoValue"].ToString() != "")
            //    {
            //        CommonHelper.CalculationValue(row);

            //        //CheckElasticInput();
            //    }
            //    #endregion

            //}
            //else if (bandedGridView1.FocusedColumn.FieldName == "ElasticMod"
            //    || bandedGridView1.FocusedColumn.FieldName == "ShearStrength"
            //    || bandedGridView1.FocusedColumn.FieldName == "FrictionAngle")
            //{
            //    if (bandedGridView1.FocusedColumn.FieldName == "ElasticMod" && e.Value.ToString() == Kpa)
            //    {
            //        row["ElasticModValue"] = 100000;
            //    }
            //    else if (bandedGridView1.FocusedColumn.FieldName == "ElasticMod" &&
            //        (e.Value.ToString() == E10N
            //        || e.Value.ToString() == E7N
            //        || e.Value.ToString() == E4N
            //        ))
            //    {
            //        CommonHelper.CalculationValue(row);
            //    }
            //    else if (bandedGridView1.FocusedColumn.FieldName == "ElasticMod" && e.Value.ToString() == DirectInput)
            //    {
            //        row["ElasticModValue"] = DBNull.Value;
            //    }
            //    else if (bandedGridView1.FocusedColumn.FieldName == "ShearStrength" && e.Value.ToString() == DirectInput)
            //    {
            //        row["ShearStrengthValue"] = DBNull.Value;
            //    }
            //    else if (bandedGridView1.FocusedColumn.FieldName == "FrictionAngle" && e.Value.ToString() == DirectInput)
            //    {
            //        row["FrictionAngleValue"] = DBNull.Value;
            //    }
            //    else
            //    {
            //        if (row["SourceOfInfoValue"].ToString() != "")
            //        {
            //            CommonHelper.CalculationValue(row);

            //            //CheckElasticInput();
            //        }
            //    }
            //}
            //else if (bandedGridView1.FocusedColumn.FieldName == "SourceOfInfoValue")
            //{
            //    CommonHelper.CalculationValue(row);

            //    //CheckElasticInput();
            //}

```


```C#
 foreach (DataRow sysRow in dtSystemPath.Select("Check = true"))
                    {
                        if (sysRow.ItemArray[0].ToString() == targetItem.SystemID.ToString())
                        {
                        }
                    }            

                    if (!dtSystemPath.AsEnumerable().Where(r => (bool)r["Check"] == true && r[0].ToString() == targetItem.SystemID.ToString()).Any())   {
                        
                    }    
```




```C#

                    #region PDMS에 삭제할 데이터 모음집
                    //선택한객체가 Delete상태이고 PDMS에 존재하는 상태이면 삭제.
                    List<string> temp_notes = new List<string>();
                    foreach (RevisionItemInfo revision_item in this.PedasSystems)
                    {
                        foreach (PedasFileInfo pedasFileInfo in this.ConvertList)
                        {
                            for (int i = pedasFileInfo.FDN_LISTS.Count - 1; i >= 0; i--)
                            {
                                if (pedasFileInfo.FDN_LISTS[i].S3D_Note == revision_item.Note
                                    && pedasFileInfo.FDN_LISTS[i].RevisionType == RevisionDataType.Deleted)
                                {
                                    temp_notes.Add(revision_item.Note);
                                    pedasFileInfo.FDN_LISTS.RemoveAt(i);
                                }
                            }
                            for (int i = pedasFileInfo.FDNPED_LISTS.Count - 1; i >= 0; i--)
                            {
                                if (pedasFileInfo.FDNPED_LISTS[i].S3D_Note == revision_item.Note
                                    && pedasFileInfo.FDNPED_LISTS[i].RevisionType == RevisionDataType.Deleted)
                                {
                                    temp_notes.Add(revision_item.Note);
                                    pedasFileInfo.FDNPED_LISTS.RemoveAt(i);
                                }
                            }
                            for (int i = pedasFileInfo.TieGirder_LISTS.Count - 1; i >= 0; i--)
                            {
                                if (pedasFileInfo.TieGirder_LISTS[i].S3D_Note == revision_item.Note
                                    && pedasFileInfo.TieGirder_LISTS[i].RevisionType == RevisionDataType.Deleted)
                                {
                                    temp_notes.Add(revision_item.Note);
                                    pedasFileInfo.TieGirder_LISTS.RemoveAt(i);
                                }
                            }
                        }
                    }

                    if (targetItem != null)
                    {
                        //PDMS에서 지워야할 타겟들
                        DataSet dsTarget = new DataSet("TARGET_ITEM");
                        DataTable dtTarget = new DataTable("TARGETS");
                        dtTarget.Columns.Add("NOTE");
                        dsTarget.Tables.Add(dtTarget);

                        foreach (var fdnInfo in targetItem.FDN_LISTS)
                        {
                            foreach (var pfi in this.ConvertList)
                            {
                                if (pfi.FDN_LISTS.AsEnumerable().Where(r => r.S3D_Note == fdnInfo.S3D_Note).Any()
                                    && fdnInfo.RevisionType != RevisionDataType.UnChanged)
                                {
                                    DataRow drTarget = dtTarget.NewRow();
                                    drTarget["NOTE"] = fdnInfo.S3D_Note;
                                    dtTarget.Rows.Add(drTarget);
                                }
                            }
                        }

                        foreach (var fdnPedInfo in targetItem.FDNPED_LISTS)
                        {
                            foreach (var pfi in this.ConvertList)
                            {
                                if (pfi.FDNPED_LISTS.AsEnumerable().Where(r => r.S3D_Note == fdnPedInfo.S3D_Note).Any()
                                    && fdnPedInfo.RevisionType != RevisionDataType.UnChanged)
                                {
                                    DataRow drTarget = dtTarget.NewRow();
                                    drTarget["NOTE"] = fdnPedInfo.S3D_Note;
                                    dtTarget.Rows.Add(drTarget);
                                }
                            }
                        }

                        foreach (var TieGirderInfo in targetItem.TieGirder_LISTS)
                        {
                            foreach (var pfi in this.ConvertList)
                            {
                                if (pfi.TieGirder_LISTS.AsEnumerable().Where(r => r.S3D_Note == TieGirderInfo.S3D_Note).Any()
                                    && TieGirderInfo.RevisionType != RevisionDataType.UnChanged)
                                {
                                    DataRow drTarget = dtTarget.NewRow();
                                    drTarget["NOTE"] = TieGirderInfo.S3D_Note;
                                    dtTarget.Rows.Add(drTarget);
                                }
                            }
                        }

                        foreach (string del_notes in temp_notes)
                        {
                            DataRow drTarget = dtTarget.NewRow();
                            drTarget["NOTE"] = del_notes;
                            dtTarget.Rows.Add(drTarget);
                        }

                        SetToXmlFile(dsTarget, this.XmlDataFolderPath_FOUNDATION, XmlDataFolderPath_FOUNDATION + "\\TARGET_ITEM.xml");
                    }
                    #endregion
```